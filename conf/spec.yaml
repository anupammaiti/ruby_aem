bundle:
  responses:
    404:
      status: failure
      handler: simple
      message: 'Bundle %{name} not found'
  actions:
    start:
      api: console
      operation: post_bundle
      params:
        required:
          name: '%{name}'
          action: start
      responses:
        200:
          status: success
          handler: simple
          message: 'Bundle %{name} started'
    stop:
      api: console
      operation: post_bundle
      params:
        required:
          name: '%{name}'
          action: stop
      responses:
        200:
          status: success
          handler: simple
          message: 'Bundle %{name} stopped'
group:
  responses:
    404:
      status: success
      handler: simple
      message: 'Group %{name} not found'
  actions:
    create:
      api: sling
      operation: post_authorizables
      params:
        required:
          authorizable_id: '%{name}'
          intermediate_path: '%{path}'
        optional:
          create_group: ''
          profilegiven_name: '%{name}'
      responses:
        201:
          status: success
          handler: html_authorizable_id
          message: 'Group %{name} created at %{path}/%{authorizable_id}'
    find_authorizable_id:
      api: sling
      operation: post_query
      params:
        required:
          path: '%{path}'
          p_limit: '-1'
          _1_property: rep:authorizableId
          _1_property_value: '%{name}'
      responses:
        200:
          status: success
          handler: json_authorizable_id
          message: 'Found group %{name} authorizable ID %{authorizable_id}'
    delete:
      api: sling
      operation: delete_node
      params:
        required:
          path: '%{path}'
          name: '%{authorizable_id}'
      responses:
        204:
          status: success
          handler: simple
          message: 'Group %{name} deleted at /%{path}/%{authorizable_id}'
    exists:
      api: sling
      operation: get_node
      params:
        required:
          path: '%{path}'
          name: '%{authorizable_id}'
      responses:
        302:
          status: success
          handler: simple
          message: 'Group %{name} exists at /%{path}/%{authorizable_id}'
    set_permission:
      api: cq
      operation: post_cq_actions
      params:
        required:
          authorizable_id: '%{name}'
          changelog: 'path:%{permission_path},%{permission_csv}'
      responses:
        200:
          status: success
          handler: simple
          message: 'Permission %{permission_csv} on path %{permission_path} set for group %{name}'
    add_member:
      api: sling
      operation: post_node
      params:
        required:
          path: '%{group_path}'
          name: '%{group_authorizable_id}'
        optional:
          add_members: '%{name}'
      responses:
        200:
          status: success
          handler: simple
          message: 'User %{name} added to group %{group_name}'
node:
  responses:
    404:
      status: failure
      handler: simple
      message: 'Node %{path}/%{name} not found'
  actions:
    create:
      api: sling
      operation: post_path
      params:
        required:
          path: '%{path}'
          jcrprimary_type: '%{type}'
          name: '%{name}'
      responses:
        201:
          status: success
          handler: simple
          message: 'Node %{path}/%{name} created'
    delete:
      api: sling
      operation: delete_node
      params:
        required:
          path: '%{path}'
          name: '%{name}'
      responses:
        204:
          status: success
          handler: simple
          message: 'Node %{path}/%{name} deleted'
    exists:
      api: sling
      operation: get_node
      params:
        required:
          path: '%{path}'
          name: '%{name}'
      responses:
        302:
          status: success
          handler: simple
          message: 'Node %{path}/%{name} exists'
path:
  actions:
    activate:
      api: sling
      operation: post_tree_activation
      params:
        required:
          ignoredeactivated: '%{ignoredeactivated}'
          onlymodified: '%{onlymodified}'
          path: '%{name}'
      responses:
        200:
          status: success
          handler: simple
          message: 'Path %{name} activated'
configproperty:
  actions:
    create:
      api: sling
      operation: post_path
      params:
        required:
          runmode: '%{run_mode}'
          name: '%{name}'
        optional:
          - org_apache_felix_https_nio
          - org_apache_felix_https_nio_type_hint
          - org_apache_felix_https_keystore
          - org_apache_felix_https_keystore_type_hint
          - org_apache_felix_https_keystore_password
          - org_apache_felix_https_keystore_password_type_hint
          - org_apache_felix_https_keystore_key
          - org_apache_felix_https_keystore_key_type_hint
          - org_apache_felix_https_keystore_key_password
          - org_apache_felix_https_keystore_key_password_type_hint
          - org_apache_felix_https_truststore
          - org_apache_felix_https_truststore_key_type_hint
          - org_apache_felix_https_truststore_password
          - org_apache_felix_https_truststore_password_type_hint
          - org_apache_felix_https_clientcertificate
          - org_apache_felix_https_clientcertificate_type_hint
          - org_apache_felix_https_enable
          - org_apache_felix_https_enable_type_hint
          - org_osgi_service_http_port_secure
          - org_osgi_service_http_port_secure_type_hint
      responses:
        200:
          status: success
          handler: simple
          message: 'Set %{run_mode} config %{type} property %{name}=%{value}'
        201:
          status: success
          handler: simple
          message: 'Set %{run_mode} config %{type} property %{name}=%{value}'
repository:
  actions:
    block_writes:
      api: console
      operation: post_jmx_repository
      params:
        required:
          action: blockRepositoryWrites
      responses:
        200:
          status: success
          handler: simple
          message: 'Repository writes blocked'
    unblock_writes:
      api: console
      operation: post_jmx_repository
      params:
        required:
          action: unblockRepositoryWrites
      responses:
        200:
          status: success
          handler: simple
          message: 'Repository writes unblocked'
user:
  responses:
    404:
      status: success
      handler: simple
      message: 'User %{name} not found'
  actions:
    create:
      api: sling
      operation: post_authorizables
      params:
        required:
          authorizable_id: '%{name}'
          intermediate_path: '%{path}'
        optional:
          create_user: ''
          reppassword: '%{password}'
      responses:
        201:
          status: success
          handler: html_authorizable_id
          message: 'User %{name} created at %{path}/%{authorizable_id}'
    find_authorizable_id:
      api: sling
      operation: post_query
      params:
        required:
          path: '%{path}'
          p_limit: '-1'
          _1_property: rep:authorizableId
          _1_property_value: '%{name}'
      responses:
        200:
          status: success
          handler: json_authorizable_id
          message: 'Found user %{name} authorizable ID %{authorizable_id}'
    delete:
      api: sling
      operation: delete_node
      params:
        required:
          path: '%{path}'
          name: '%{authorizable_id}'
      responses:
        204:
          status: success
          handler: simple
          message: 'User %{name} deleted at /%{path}/%{authorizable_id}'
    exists:
      api: sling
      operation: get_node
      params:
        required:
          path: '%{path}'
          name: '%{authorizable_id}'
      responses:
        302:
          status: success
          handler: simple
          message: 'User %{name} exists at /%{path}/%{authorizable_id}'
    set_permission:
      api: cq
      operation: post_cq_actions
      params:
        required:
          authorizable_id: '%{name}'
          changelog: 'path:%{permission_path},%{permission_csv}'
      responses:
        200:
          status: success
          handler: simple
          message: 'Permission %{permission_csv} on path %{permission_path} set for user %{name}'
    add_to_group:
      api: sling
      operation: post_node
      params:
        required:
          path: '%{group_path}'
          name: '%{group_authorizable_id}'
        optional:
          add_members: '%{name}'
      responses:
        200:
          status: success
          handler: simple
          message: 'User %{name} added to group %{group_name}'
    change_password:
      api: crx
      operation: post_set_password
      params:
        required:
          old: '%{old_password}'
          plain: '%{new_password}'
          verify: '%{new_password}'
      responses:
        200:
          status: success
          handler: simple
          message: 'Logged in user password changed'
